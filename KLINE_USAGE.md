# Kçº¿æ•°æ®ä½¿ç”¨è¯´æ˜

## ğŸ“Š Kçº¿æ•°æ®è·å–

### è·å–æ•°é‡
ç³»ç»Ÿæ¯æ¬¡è·å– **150æ ¹Kçº¿** è¿›è¡ŒæŠ€æœ¯æŒ‡æ ‡è®¡ç®—:

```go
// main.go:188
candles, err := bot.hlClient.GetCandlestickData(symbol, bot.config.Trading.Timeframe, 150)
```

### æœ€ä½è¦æ±‚
ç³»ç»Ÿè¦æ±‚è‡³å°‘ **120æ ¹Kçº¿** æ‰èƒ½è¿›è¡Œè®¡ç®—:

```go
// main.go:193-195
if len(candles) < 120 {
    return fmt.Errorf("insufficient candle data: got %d, need at least 120", len(candles))
}
```

---

## ğŸ”§ å„æŠ€æœ¯æŒ‡æ ‡ä½¿ç”¨çš„Kçº¿æ•°é‡

### 1. **ç§»åŠ¨å¹³å‡çº¿ (MA)**

| æŒ‡æ ‡ | å‘¨æœŸ | ä½¿ç”¨Kçº¿æ•° | è¯´æ˜ |
|------|------|----------|------|
| SMA10 | 10 | 10 | 10å‘¨æœŸç®€å•ç§»åŠ¨å¹³å‡ |
| SMA60 | 60 | 60 | 60å‘¨æœŸç®€å•ç§»åŠ¨å¹³å‡ |
| SMA120 | 120 | 120 | 120å‘¨æœŸç®€å•ç§»åŠ¨å¹³å‡ âš ï¸ æœ€é•¿ |
| EMA10 | 10 | 10+ | 10å‘¨æœŸæŒ‡æ•°ç§»åŠ¨å¹³å‡ |
| EMA60 | 60 | 60+ | 60å‘¨æœŸæŒ‡æ•°ç§»åŠ¨å¹³å‡ |
| EMA120 | 120 | 120+ | 120å‘¨æœŸæŒ‡æ•°ç§»åŠ¨å¹³å‡ âš ï¸ æœ€é•¿ |

**ä»£ç ä½ç½®:**
```go
// indicators/calculator.go:81-88
indicators.SMA10 = c.SMA(closes, 10)
indicators.SMA60 = c.SMA(closes, 60)
indicators.SMA120 = c.SMA(closes, 120)

indicators.EMA10 = c.EMA(closes, 10)
indicators.EMA60 = c.EMA(closes, 60)
indicators.EMA120 = c.EMA(closes, 120)
```

---

### 2. **MACD (Moving Average Convergence Divergence)**

| ç»„ä»¶ | å‘¨æœŸ | ä½¿ç”¨Kçº¿æ•° | è¯´æ˜ |
|------|------|----------|------|
| EMA12 | 12 | 12+ | å¿«é€ŸEMA |
| EMA26 | 26 | 26+ | æ…¢é€ŸEMA |
| DIF | - | 26+ | EMA12 - EMA26 |
| DEA (ä¿¡å·çº¿) | 9 | 26+9=35+ | DIFçš„9å‘¨æœŸEMA |
| HIST (æŸ±çŠ¶å›¾) | - | 35+ | DIF - DEA |

**ä»£ç ä½ç½®:**
```go
// indicators/calculator.go:91
indicators.MACDDIF, indicators.MACDDEA, indicators.MACDHIST = c.MACD(closes)

// MACDè®¡ç®—ç»†èŠ‚ (calculator.go:142-177)
ema12 := c.EMASequence(data, 12)
ema26 := c.EMASequence(data, 26)
difSeq := ema12 - ema26
deaSeq := c.EMASequence(difSeq, 9)
```

**å®é™…éœ€è¦:** çº¦ **35æ ¹Kçº¿** (26 + 9)

---

### 3. **RSI (Relative Strength Index)**

| æŒ‡æ ‡ | å‘¨æœŸ | ä½¿ç”¨Kçº¿æ•° | è¯´æ˜ |
|------|------|----------|------|
| RSI14 | 14 | 15 | 14å‘¨æœŸRSI (éœ€è¦15æ ¹è®¡ç®—å˜åŒ–) |

**ä»£ç ä½ç½®:**
```go
// indicators/calculator.go:94
indicators.RSI14 = c.RSI(closes, 14)

// RSIè®¡ç®—ç»†èŠ‚ (calculator.go:200-229)
// éœ€è¦period+1æ ¹Kçº¿æ¥è®¡ç®—ä»·æ ¼å˜åŒ–
if len(data) < period+1 {
    return 50
}
```

**å®é™…éœ€è¦:** **15æ ¹Kçº¿** (14å‘¨æœŸ + 1æ ¹è®¡ç®—å˜åŒ–)

---

### 4. **å¸ƒæ—å¸¦ (Bollinger Bands)**

| æŒ‡æ ‡ | å‘¨æœŸ | ä½¿ç”¨Kçº¿æ•° | è¯´æ˜ |
|------|------|----------|------|
| BBä¸­è½¨ (Middle) | 20 | 20 | 20å‘¨æœŸSMA |
| BBä¸Šè½¨ (Upper) | 20 | 20 | ä¸­è½¨ + 2å€æ ‡å‡†å·® |
| BBä¸‹è½¨ (Lower) | 20 | 20 | ä¸­è½¨ - 2å€æ ‡å‡†å·® |

**ä»£ç ä½ç½®:**
```go
// indicators/calculator.go:97-98
indicators.BBUpper, indicators.BBMiddle, indicators.BBLower = c.BollingerBands(closes, 20, 2)

// å¸ƒæ—å¸¦è®¡ç®— (calculator.go:232-250)
middle = c.SMA(data, 20)  // 20å‘¨æœŸSMA
std = è®¡ç®—æ ‡å‡†å·®(20ä¸ªæ•°æ®ç‚¹)
upper = middle + (2 * std)
lower = middle - (2 * std)
```

**å®é™…éœ€è¦:** **20æ ¹Kçº¿**

---

### 5. **æˆäº¤é‡æŒ‡æ ‡ (Volume)**

| æŒ‡æ ‡ | å‘¨æœŸ | ä½¿ç”¨Kçº¿æ•° | è¯´æ˜ |
|------|------|----------|------|
| VMA20 | 20 | 20 | 20å‘¨æœŸæˆäº¤é‡ç§»åŠ¨å¹³å‡ |

**ä»£ç ä½ç½®:**
```go
// indicators/calculator.go:101
indicators.VMA20 = c.SMA(volumes, 20)
```

**å®é™…éœ€è¦:** **20æ ¹Kçº¿**

---

## ğŸ“Š ä¸ºä»€ä¹ˆè·å–150æ ¹Kçº¿?

### è®¡ç®—éœ€æ±‚åˆ†æ

| æŒ‡æ ‡ | æœ€é•¿å‘¨æœŸ | éœ€è¦Kçº¿æ•° |
|------|---------|----------|
| SMA/EMA | 120 | 120 |
| MACD | 26+9 | ~35 |
| RSI | 14+1 | 15 |
| å¸ƒæ—å¸¦ | 20 | 20 |
| VMA | 20 | 20 |
| **æœ€å¤§éœ€æ±‚** | **SMA120/EMA120** | **120** |

### è®¾ç½®150æ ¹çš„åŸå› 

1. **æ»¡è¶³æœ€é•¿å‘¨æœŸéœ€æ±‚**
   - SMA120/EMA120 éœ€è¦ 120æ ¹
   - 150 > 120 âœ… æ»¡è¶³

2. **æä¾›å®‰å…¨ä½™é‡**
   - ä½™é‡: 150 - 120 = 30æ ¹
   - åº”å¯¹æ•°æ®ç¼ºå¤±æˆ–å¼‚å¸¸
   - ç¡®ä¿æ‰€æœ‰æŒ‡æ ‡éƒ½èƒ½æ­£ç¡®è®¡ç®—

3. **æ€§èƒ½è€ƒè™‘**
   - 150æ ¹æ•°æ®é‡é€‚ä¸­
   - ä¸ä¼šè¿‡åº¦å ç”¨å†…å­˜
   - APIè°ƒç”¨æ•ˆç‡åˆç†

---

## ğŸ” å®é™…ä½¿ç”¨æƒ…å†µ

### ä»£ç æ‰§è¡Œæµç¨‹

```go
// main.go äº¤æ˜“å‘¨æœŸæ‰§è¡Œæµç¨‹

// æ­¥éª¤1: è·å–150æ ¹Kçº¿
candles, err := bot.hlClient.GetCandlestickData(symbol, timeframe, 150)

// æ­¥éª¤2: éªŒè¯æ•°é‡
if len(candles) < 120 {
    return error  // æ•°æ®ä¸è¶³
}

// æ­¥éª¤3: è®¡ç®—æŒ‡æ ‡ (ä½¿ç”¨æ‰€æœ‰150æ ¹)
indicators := bot.calculator.Calculate(candles)

// Calculateå‡½æ•°å†…éƒ¨:
// - SMA10: ä½¿ç”¨æœ€å10æ ¹
// - SMA60: ä½¿ç”¨æœ€å60æ ¹
// - SMA120: ä½¿ç”¨æœ€å120æ ¹
// - MACD: ä½¿ç”¨æ‰€æœ‰æ•°æ®è®¡ç®—EMAåºåˆ—
// - RSI14: ä½¿ç”¨æœ€å15æ ¹
// - BB20: ä½¿ç”¨æœ€å20æ ¹
// - VMA20: ä½¿ç”¨æœ€å20æ ¹æˆäº¤é‡
```

---

## ğŸ“ˆ Kçº¿æ—¶é—´æ¡†æ¶

Kçº¿å‘¨æœŸç”±é…ç½®æ–‡ä»¶æ§åˆ¶:

```yaml
# config.yaml
trading:
  timeframe: "5m"  # å¯é€‰: 1m, 5m, 15m, 1h, 4h, 1d
```

### ä¸åŒæ—¶é—´æ¡†æ¶çš„å«ä¹‰

| æ—¶é—´æ¡†æ¶ | 150æ ¹Kçº¿ä»£è¡¨ | å®é™…æ—¶é—´è·¨åº¦ |
|---------|-------------|------------|
| 1m | 150åˆ†é’Ÿ | 2.5å°æ—¶ |
| 5m | 750åˆ†é’Ÿ | 12.5å°æ—¶ |
| 15m | 2250åˆ†é’Ÿ | 37.5å°æ—¶ (1.5å¤©) |
| 1h | 150å°æ—¶ | 6.25å¤© |
| 4h | 600å°æ—¶ | 25å¤© |
| 1d | 150å¤© | 5ä¸ªæœˆ |

**ç¤ºä¾‹ (5åˆ†é’ŸKçº¿):**
- è·å–150æ ¹Kçº¿ = æœ€è¿‘ 750åˆ†é’Ÿ = 12.5å°æ—¶çš„æ•°æ®
- SMA120 = æœ€è¿‘120æ ¹Kçº¿ = 600åˆ†é’Ÿ = 10å°æ—¶çš„ç§»åŠ¨å¹³å‡

---

## âš™ï¸ é…ç½®å»ºè®®

### å½“å‰é…ç½® (é»˜è®¤)
```go
è·å–æ•°é‡: 150æ ¹
æœ€ä½è¦æ±‚: 120æ ¹
ä½™é‡: 30æ ¹
```

### å¦‚æœè¦ä¿®æ”¹

**å¢åŠ åˆ°200æ ¹:**
```go
// main.go:188
candles, err := bot.hlClient.GetCandlestickData(symbol, bot.config.Trading.Timeframe, 200)
```

**ä¼˜ç‚¹:**
- âœ… æ›´å¤šå†å²æ•°æ®
- âœ… EMAè®¡ç®—æ›´å¹³æ»‘
- âœ… æ›´å¤§çš„å®‰å…¨ä½™é‡

**ç¼ºç‚¹:**
- âŒ APIè¯·æ±‚æ•°æ®é‡å¢åŠ 
- âŒ è®¡ç®—æ—¶é—´ç•¥å¾®å¢åŠ 

---

## ğŸ“Š å†…å­˜å ç”¨ä¼°ç®—

### å•æ¬¡è®¡ç®—çš„æ•°æ®é‡

å‡è®¾ä½¿ç”¨5åˆ†é’ŸKçº¿,150æ ¹:

```
æ•°æ®ç»“æ„:
- æ¯æ ¹Kçº¿: ~80å­—èŠ‚ (6ä¸ªfloat64 + 1ä¸ªint64)
- 150æ ¹Kçº¿: 150 Ã— 80 = 12KB

è¡ç”Ÿæ•°ç»„:
- closes: 150 Ã— 8 = 1.2KB
- highs: 150 Ã— 8 = 1.2KB
- lows: 150 Ã— 8 = 1.2KB
- volumes: 150 Ã— 8 = 1.2KB
- å„ç§EMAåºåˆ—: ~2KB

æ€»è®¡: çº¦ 20KB / æ¯ä¸ªå¸ç§
```

**3ä¸ªå¸ç§ (ETH, BTC, DOGE):**
- æ€»å†…å­˜: 20KB Ã— 3 = 60KB
- å¯å¿½ç•¥ä¸è®¡ âœ…

---

## ğŸ¯ æ€»ç»“

| é¡¹ç›® | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| **è·å–æ•°é‡** | **150æ ¹** | æ¯æ¬¡APIè°ƒç”¨è·å–çš„Kçº¿æ•° |
| **æœ€ä½è¦æ±‚** | **120æ ¹** | ç³»ç»Ÿè¿è¡Œçš„æœ€ä½è¦æ±‚ |
| **å®‰å…¨ä½™é‡** | **30æ ¹** | 150 - 120 |
| **æœ€é•¿æŒ‡æ ‡** | **SMA120/EMA120** | éœ€è¦120æ ¹Kçº¿ |
| **å®é™…ä½¿ç”¨** | **å…¨éƒ¨150æ ¹** | æ‰€æœ‰æŒ‡æ ‡è®¡ç®—éƒ½åŸºäºè¿™150æ ¹ |

### å…³é”®ç‚¹

1. âœ… è·å–150æ ¹Kçº¿æ•°æ®
2. âœ… æœ€ä½éœ€è¦120æ ¹ (å› ä¸ºSMA120/EMA120)
3. âœ… æ¯ä¸ªæŒ‡æ ‡ä½¿ç”¨å…¶æ‰€éœ€çš„å‘¨æœŸé•¿åº¦
4. âœ… æä¾›30æ ¹ä½™é‡ç¡®ä¿ç¨³å®šæ€§
5. âœ… é€‚ç”¨äºæ‰€æœ‰é…ç½®çš„æ—¶é—´æ¡†æ¶ (1m-1d)

---

**æ–‡ä»¶ä½ç½®:**
- Kçº¿è·å–: `main.go:188`
- æœ€ä½æ£€æŸ¥: `main.go:193-195`
- æŒ‡æ ‡è®¡ç®—: `indicators/calculator.go:59-110`

**é…ç½®æ–‡ä»¶:**
- `config.yaml` - è®¾ç½®æ—¶é—´æ¡†æ¶ (timeframe)
